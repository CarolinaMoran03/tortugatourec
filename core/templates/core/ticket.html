{% extends "core/base.html" %}

{% block title %}Voucher de Reserva | TortugaTour{% endblock %}

{% block content %}
<section class="max-w-3xl mx-auto px-6 py-12 min-h-screen flex items-center justify-center">

    <!-- Ticket Container -->
    <div
        class="bg-white dark:bg-slate-900 w-full rounded-3xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden relative">

        <!-- Ticket Header (Brand) -->
        <div
            class="bg-primary px-8 py-6 text-white flex flex-col sm:flex-row items-center justify-between gap-4 relative">
            <div class="flex items-center gap-3">
                <span class="material-icons text-5xl opacity-90 notranslate" translate="no">travel_explore</span>
                <div>
                    <h1 class="text-3xl font-black tracking-tighter">TortugaTour</h1>
                    <p class="text-xs font-bold tracking-widest text-primary-light uppercase opacity-80">Agencia de
                        Viajes</p>
                </div>
            </div>

            <div class="text-center sm:text-right">
                <p class="text-[10px] uppercase tracking-widest font-bold opacity-70 mb-1">Voucher No.</p>
                <p class="text-2xl font-black font-mono">#{{ reserva.id|stringformat:"06d" }}</p>
                {% if reserva.ticket %}
                <p class="text-xs mt-1 font-mono text-white/50">{{ reserva.ticket.codigo }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Perforation Line -->
        <div class="absolute w-full h-8 -mt-4 flex items-center justify-between px-[-10px] z-10">
            <div class="w-8 h-8 rounded-full bg-slate-50 dark:bg-slate-950 -ml-4 shadow-inner"></div>
            <div class="h-0.5 w-full border-b-[3px] border-dashed border-slate-200 dark:border-slate-800 mx-4"></div>
            <div class="w-8 h-8 rounded-full bg-slate-50 dark:bg-slate-950 -mr-4 shadow-inner"></div>
        </div>

        <!-- Ticket Body -->
        <div class="p-8 sm:p-10 bg-slate-50/50 dark:bg-slate-800/50 pt-12">

            <!-- Tour Alert Status -->
            <div class="flex justify-center mb-8">
                {% if reserva.estado == 'pagada' or reserva.estado == 'confirmada' %}
                <span
                    class="bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400 font-black px-6 py-2 rounded-full uppercase tracking-widest text-sm flex items-center gap-2 border border-green-200 dark:border-green-800/50">
                    <span class="material-icons text-lg notranslate" translate="no">verified</span> Reserva Confirmada
                </span>
                {% elif reserva.estado == 'pendiente' %}
                <span
                    class="bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-400 font-black px-6 py-2 rounded-full uppercase tracking-widest text-sm flex items-center gap-2 border border-amber-200 dark:border-amber-800/50">
                    <span class="material-icons text-lg notranslate" translate="no">pending_actions</span> Pendiente de
                    Pago
                </span>
                {% else %}
                <span
                    class="bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 font-black px-6 py-2 rounded-full uppercase tracking-widest text-sm flex items-center gap-2 border border-red-200 dark:border-red-800/50">
                    <span class="material-icons text-lg notranslate" translate="no">cancel</span> Cancelada
                </span>
                {% endif %}
            </div>

            <!-- Tour details -->
            <div class="text-center mb-10">
                <h2 class="text-3xl font-black text-slate-800 dark:text-white mb-2">
                    {{ reserva.salida.tour.nombre }}
                </h2>
                <p class="text-slate-500 dark:text-slate-400 flex items-center justify-center gap-2 font-medium">
                    <span class="material-icons text-sm notranslate" translate="no">location_on</span>
                    {{ reserva.salida.tour.destino.nombre }}
                </p>
            </div>

            <!-- Grid Info -->
            <div
                class="grid grid-cols-2 md:grid-cols-4 gap-6 bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm mb-10">

                <div>
                    <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Fecha</p>
                    <p class="text-slate-800 dark:text-slate-200 font-bold whitespace-nowrap">
                        {{ reserva.salida.fecha|date:"d M Y" }}
                    </p>
                </div>

                <div>
                    <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Hora Salida</p>
                    <p class="text-slate-800 dark:text-slate-200 font-bold flex items-center gap-1">
                        <span class="material-icons text-primary text-sm notranslate" translate="no">schedule</span>
                        {{ reserva.salida.hora|time:"g:i A"|default:"Por definir" }}
                    </p>
                </div>

                <div>
                    <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Pasajeros</p>
                    <p class="text-slate-800 dark:text-slate-200 font-bold">{{ reserva.total_personas }} totales</p>
                </div>

                <div>
                    <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Monto Total</p>
                    <p class="text-primary font-black text-xl">$ {{ reserva.total_pagar }} USD</p>
                </div>

            </div>

            <!-- Customer Details -->
            <div class="border-t border-slate-200 dark:border-slate-800 pt-8">
                <h3 class="text-xs font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-4">
                    Información del Viajero Principal</h3>
                <div class="flex flex-col sm:flex-row justify-between gap-4">
                    <div>
                        <p class="text-lg font-bold text-slate-800 dark:text-slate-200">
                            {{ reserva.nombre }} {{ reserva.apellidos }}
                        </p>
                        <p class="text-sm text-slate-500 dark:text-slate-400">{{ reserva.correo }}</p>
                    </div>
                    <div class="sm:text-right">
                        <p class="text-sm text-slate-500 dark:text-slate-400">ID: {{ reserva.identificacion }}</p>
                        <p class="text-sm text-slate-500 dark:text-slate-400">Telf: {{ reserva.telefono }}</p>
                    </div>
                </div>
            </div>

        </div>

        <!-- Ticket Footer / Actions -->
        <div
            class="bg-slate-100 dark:bg-slate-950 p-6 sm:p-8 flex flex-col sm:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <div
                    class="w-12 h-12 bg-white dark:bg-slate-800 p-2 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=Reservacion%20No.{{ reserva.id }}%20-%20{{ reserva.nombre }}%20{{ reserva.apellidos }}"
                        alt="QR Code" class="w-full h-full object-cover dark:invert">
                </div>
                <div>
                    <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">Voucher Digital</p>
                    <p class="text-xs text-slate-400">Válido como pase de abordaje</p>
                </div>
            </div>

            <div class="flex gap-3 w-full sm:w-auto">
                <a href="{% url 'ver_ticket_pdf' reserva.id %}" download
                    class="flex-1 sm:flex-none border border-slate-300 dark:border-slate-700 hover:bg-white dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300 font-bold px-6 py-3 rounded-xl transition text-center flex items-center justify-center gap-2">
                    <span class="material-icons font-sm notranslate" translate="no">file_download</span> PDF
                </a>
                <a href="{% url 'mis_reservas' %}"
                    class="flex-1 sm:flex-none bg-slate-900 text-white dark:bg-white dark:text-slate-900 hover:bg-primary dark:hover:bg-primary dark:hover:text-white font-bold px-6 py-3 rounded-xl shadow-lg transition text-center">
                    Cerrar
                </a>
            </div>
        </div>

    </div>
</section>
{% endblock %}